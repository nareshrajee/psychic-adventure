rank() over(partition by dept order by saary) from tabl;
use cte instead of subqueries;
